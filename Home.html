<!DOCTYPE html>
<html lang="ar">
<head> 
  
  <link rel="icon" href="favicon.ico" type="image/ico">
  <meta charset="UTF-8">

  <title>ğŸ“š Ù…ÙƒØªØ¨ØªÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Ù…ÙƒØªØ¨Ø§Øª -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <style>
    body {
      font-family: "Cairo", sans-serif;
      margin: 0;
      background: #f3f4f6;
      color: #333;
      transition: 0.3s;
      direction: rtl;
    }
    body.dark {
      background: #111827;
      color: #e5e7eb;
    }
    header {
      background: linear-gradient(135deg, #4f46e5, #6366f1);
      color: white;
      padding: 25px 20px;
      font-size: 22px;
      font-weight: bold;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .toggle-btn {
      background: white;
      color: #4f46e5;
      border: none;
      border-radius: 8px;
      padding: 6px 10px;
      cursor: pointer;
      font-size: 14px;
    }
    body.dark .toggle-btn {
      background: #1f2937;
      color: #f3f4f6;
    }
    main {
      max-width: 900px;
      margin: 30px auto;
      padding: 0 15px;
    }
    .controls {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    input, button {
      padding: 10px 15px;
      border-radius: 8px;
      border: none;
      font-size: 14px;
    }
    input {
      flex: 1;
      border: 1px solid #ddd;
    }
    button {
      cursor: pointer;
      background: #4f46e5;
      color: white;
      transition: 0.2s;
    }
    button:hover {
      background: #3730a3;
    }
    .subject-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transition: 0.3s;
    }
    body.dark .subject-card {
      background: #1f2937;
      color: #f9fafb;
    }
    .subject-card h3 {
      margin: 0 0 10px;
    }
    .actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .actions button {
      flex: 1;
    }
    /* Ø²Ø±Ø§Ø± Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„Ù */
    .file-label {
      display: inline-block;
      padding: 10px 15px;
      background: #6366f1;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: 0.2s;
    }
    .file-label:hover {
      background: #4f46e5;
    }
    input[type="file"] {
      display: none;
    }
    .download-all {
      margin: 20px 0;
      text-align: center;
    }




    
    
.link-btn {
  
  text-align: center;
 
}

.link-btn a {
  display: inline-block;
  background: linear-gradient(135deg, #4f46e5, #6366f1);
  color: white;
  padding: 5px 5px;
  border-radius: 10px;
  text-decoration: none;
  font-size: 16px;
  font-weight: bold;
  transition: 0.3s;
}

.link-btn a:hover {
  background: linear-gradient(135deg, #3730a3, #4f46e5);
}


    
  </style>
</head>
<body>
  <header>
    <span>ğŸ“š Ù…ÙƒØªØ¨ØªÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</span>

<div class="link-btn">
  <a href="https://ah9742824-oss.github.io/my-project/" target="_blank">ğŸŒ</a>
  
  </div>
  
    <button class="toggle-btn" onclick="toggleDarkMode()">ğŸŒ™/â˜€ï¸</button>


  
  </header>
  <main>
    <div class="controls">
      <input type="text" id="subjectName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©...">
      <button onclick="addSubject()">â• Ø¥Ø¶Ø§ÙØ©</button>
    </div>
    <div id="subjects"></div>
    <div class="download-all">
      <button onclick="downloadAll()">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª ZIP</button>
    </div>
  </main>

  <script>
    const { jsPDF } = window.jspdf;
    let subjects = JSON.parse(localStorage.getItem("subjects") || "[]");

    function saveSubjects() {
      localStorage.setItem("subjects", JSON.stringify(subjects));
    }

    function renderSubjects() {
      const container = document.getElementById("subjects");
      container.innerHTML = "";
      subjects.forEach((subj, i) => {
        const div = document.createElement("div");
        div.className = "subject-card";
        div.innerHTML = `
          <h3>${subj.name}</h3>
          <label class="file-label" for="fileInput-${i}">ğŸ“‚ Ø§Ø®ØªØ± ØµÙˆØ±</label>
          <input type="file" id="fileInput-${i}" multiple accept="image/*">
          <div class="actions">
            <button onclick="convertToPDF(${i})">ğŸ“„ Ø¥Ù†Ø´Ø§Ø¡/ØªØ­Ø¯ÙŠØ« PDF</button>
            <button onclick="openPDF(${i})">ğŸ“– Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù</button>
            <button onclick="downloadPDF(${i})">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù</button>
            <button onclick="editSubject(${i})">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù…</button>
            <button onclick="deleteSubject(${i})" style="background:#dc2626">ğŸ—‘ï¸ Ø­Ø°Ù</button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function addSubject() {
      const name = document.getElementById("subjectName").value.trim();
      if (!name) return alert("âš ï¸ Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©");
      subjects.push({ name, pdf: null, pdfName: null });
      saveSubjects();
      renderSubjects();
      document.getElementById("subjectName").value = "";
    }

    function deleteSubject(i) {
      if (confirm("Ù‡Ù„ Ø§Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ")) {
        subjects.splice(i, 1);
        saveSubjects();
        renderSubjects();
      }
    }

    function editSubject(i) {
      const newName = prompt("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯:", subjects[i].name);
      if (newName) {
        subjects[i].name = newName;
        saveSubjects();
        renderSubjects();
      }
    }

    window.convertToPDF = (index) => {
      const input = document.getElementById(`fileInput-${index}`);
      if (!input.files.length && !subjects[index].pdf) 
        return alert("ğŸ“Œ Ø§Ø®ØªØ§Ø± ØµÙˆØ± Ø§Ù„Ø£ÙˆÙ„");

      const pdf = new jsPDF("p", "mm", "a4");

      let files = input.files.length ? Array.from(input.files) : [];

      if (subjects[index].pdf) {
        alert("ğŸ“ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¨Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯.");
      }

      let count = 0;
      files.forEach((file, i) => {
        const reader = new FileReader();
        reader.onload = function(e) {
          const img = new Image();
          img.onload = function() {
            const imgWidth = 210;
            const imgHeight = (img.height * imgWidth) / img.width;
            if (i > 0) pdf.addPage();
            pdf.addImage(img, "JPEG", 0, 0, imgWidth, imgHeight);

            count++;
            if (count === files.length) {
              const pdfName = `${subjects[index].name}.pdf`;
              const pdfBlob = pdf.output("blob");
              const pdfUrl = URL.createObjectURL(pdfBlob);
              subjects[index].pdf = pdfUrl;
              subjects[index].pdfName = pdfName;
              saveSubjects();
              renderSubjects();
              alert(`âœ… ØªÙ… Ø­ÙØ¸ Ù…Ù„Ù ${pdfName} Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø§Ø¯Ø©`);
            }
          };
          img.src = e.target.result;
        };
        reader.readAsDataURL(file);
      });
    };

    window.openPDF = (index) => {
      if (!subjects[index].pdf) return alert("ğŸ“Œ Ù…ÙÙŠØ´ Ù…Ù„Ù Ù…Ø­ÙÙˆØ¸");
      window.open(subjects[index].pdf, "_blank");
    };

    window.downloadPDF = (index) => {
      if (!subjects[index].pdf) return alert("ğŸ“Œ Ù…ÙÙŠØ´ Ù…Ù„Ù Ù…Ø­ÙÙˆØ¸");
      const link = document.createElement("a");
      link.href = subjects[index].pdf;
      link.download = subjects[index].pdfName;
      link.click();
    };

    function downloadAll() {
      const zip = new JSZip();
      let count = 0;
      const total = subjects.filter(s => s.pdf).length;

      if (total === 0) return alert("ğŸ“Œ Ù…ÙÙŠØ´ Ù…Ù„ÙØ§Øª Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„ØªØ­Ù…ÙŠÙ„");

      subjects.forEach(subj => {
        if (subj.pdf) {
          fetch(subj.pdf).then(res => res.blob()).then(blob => {
            zip.file(subj.pdfName, blob);
            count++;
            if (count === total) {
              zip.generateAsync({ type: "blob" }).then(content => {
                saveAs(content, "ÙƒÙ„_Ø§Ù„Ù…Ù„ÙØ§Øª.zip");
              });
            }
          });
        }
      });
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark");
    }

    renderSubjects();

    // ØªØ­Ø°ÙŠØ± Ù‚Ø¨Ù„ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
    window.addEventListener("beforeunload", function (e) {
      e.preventDefault();
      e.returnValue = "âš ï¸ Ø§Ù†Øª Ø¹Ù„Ù‰ ÙˆØ´Ùƒ Ø§Ù„Ø®Ø±ÙˆØ¬ØŒ Ù‡Ù„ Ù…ØªØ£ÙƒØ¯ Ø§Ù†Ùƒ Ø¹Ø§ÙŠØ² ØªÙ‚ÙÙ„ØŸ";
    });
  </script>
</body>
</html>
